
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>scopy.ScoDruglikeness.molproperty_Lib &#8212; Scopy 1.2.3 documentation</title>
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/./cssbasic.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Scopy 1.2.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../scopy.html" accesskey="U">scopy</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/Scopy.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for scopy.ScoDruglikeness.molproperty_Lib</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Fri May 15 22:47:38 2020</span>

<span class="sd">@Author: Zhi-Jiang Yang, Dong-Sheng Cao</span>
<span class="sd">@Institution: CBDD Group, Xiangya School of Pharmaceutical Science, CSU, China</span>
<span class="sd">@Homepage: http://www.scbdd.com</span>
<span class="sd">@Mail: yzjkid9@gmail.com; oriental-cds@163.com</span>
<span class="sd">@Blog: https://blog.iamkotori.com</span>

<span class="sd">♥I love Princess Zelda forever♥</span>
<span class="sd">&quot;&quot;&quot;</span>



<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="k">import</span> <span class="n">Pool</span>
<span class="kn">from</span> <span class="nn">rdkit</span> <span class="k">import</span> <span class="n">Chem</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">molproperty</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">ScoConfig</span>
<span class="kn">from</span> <span class="nn">..ScoRepresent.fingerprints</span> <span class="k">import</span> <span class="n">CalculateGhoseCrippen</span>

    


<span class="k">def</span> <span class="nf">_GetSmi</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the SMILES of molecule</span>
<span class="sd">    </span>
<span class="sd">    :param mols: molecule</span>
<span class="sd">    :type mols: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: The SMILES of molecule</span>
<span class="sd">    :rtype: string</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    

<div class="viewcode-block" id="PC_properties"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties">[docs]</a><span class="k">class</span> <span class="nc">PC_properties</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Here, we comdat the whole function that computing property retrieved from module molproperty</span>
<span class="sd">    </span>
<span class="sd">    :param mols: The molecule to be scanned.</span>
<span class="sd">    :type mols: Iterable object, each element is rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :param n_jobs: The number of CPUs to use to do the computation, defaults to 1</span>
<span class="sd">    :type n_jobs: int, optional</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mols</span> <span class="o">=</span> <span class="n">mols</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">Mol</span> <span class="k">else</span> <span class="p">[</span><span class="n">mols</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span> <span class="k">if</span> <span class="n">n_jobs</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span>
    
<div class="viewcode-block" id="PC_properties.CalculateMolWeight"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateMolWeight">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateMolWeight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>    
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of molecular weight(contain hydrogen atoms)   </span>
<span class="sd">        ---&gt;MW  </span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the weight of molecule(contain hydrogen atoms)</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">MW</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateMolWeight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">MW</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumBonds"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumBonds">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumBonds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation the number of bonds where between heavy atoms       </span>
<span class="sd">        ---&gt;nBond</span>
<span class="sd">            </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of bonds where between heavy atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nBond</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumBonds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nBond</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumAtoms"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumAtoms">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of the number of atoms in molecular(contain hydrogen atoms) </span>
<span class="sd">        ---&gt;nAtom</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of atoms in molecular(contain hydrogen atoms)</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>  
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nAtom</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumAtoms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nAtom</span></div>
        
<div class="viewcode-block" id="PC_properties.CalculateNumHetero"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumHetero">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumHetero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of the number of heteroatom in a molecule  </span>
<span class="sd">        ---&gt;nHet</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of heteroatom in a molecule  </span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nHet</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumHetero</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nHet</span></div>
    
    
<div class="viewcode-block" id="PC_properties.CalculateNumRotatableBonds"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumRotatableBonds">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumRotatableBonds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of the number of rotatableBonds</span>
<span class="sd">        ---&gt;nRot</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            In some situaion Amide C-N bonds are not considered </span>
<span class="sd">            because of their high rotational energy barrier</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of rotatableBond  </span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nRot</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumRotatableBonds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nRot</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumRigidBonds"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumRigidBonds">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumRigidBonds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of non-flexible bonds, in opposite to rotatable bonds    </span>
<span class="sd">        ---&gt;nRig</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of non-flexible bonds </span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nRig</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumRigidBonds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nRig</span></div>
     
<div class="viewcode-block" id="PC_properties.CalculateFlexibility"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateFlexibility">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateFlexibility</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The flexibility (ration between rotatable and rigid bonds)</span>
<span class="sd">        ---&gt;Flex</span>
<span class="sd">        </span>
<span class="sd">        :param mol: molecules</span>
<span class="sd">        :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">        :return: the number of ring   </span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">Flex</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateFlexibility</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Flex</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumRing"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumRing">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumRing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of the number of ring   </span>
<span class="sd">        ---&gt;nRing</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of ring   </span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nRing</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumRing</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nRing</span></div>
       
<div class="viewcode-block" id="PC_properties.CalculateNumHeavyAtom"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumHeavyAtom">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumHeavyAtom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of Heavy atom counts in a molecule   </span>
<span class="sd">        ---&gt;nHev</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of heavy atom counts in a molecule  </span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nHev</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumHeavyAtom</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nHev</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateLogD"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateLogD">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateLogD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of molecular logD under pH=7.4</span>
<span class="sd">        ---&gt;LogD</span>
<span class="sd">        </span>
<span class="sd">        Note:</span>
<span class="sd">            We have built a liner model with DNN to predict logD7.4.</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: molecular logD under pH=7.4 </span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">intercept</span> <span class="o">=</span> <span class="mf">0.5748907159915493</span>
    
        <span class="n">fps</span> <span class="o">=</span> <span class="n">CalculateGhoseCrippen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ScoConfig</span><span class="o">.</span><span class="n">CrippenDir</span><span class="p">,</span> <span class="s1">&#39;Crippen.txt&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f_obj</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f_obj</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">next</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
            <span class="n">contri</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
            <span class="n">contri</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">contri</span><span class="p">]</span>
        <span class="n">f_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">logD</span> <span class="o">=</span> <span class="p">(</span><span class="n">fps</span><span class="o">*</span><span class="n">contri</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">logD</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateLogP"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateLogP">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateLogP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>    
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of molecular LogP</span>
<span class="sd">        ---&gt;logP</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: molecular logP </span>
<span class="sd">        :rtype: float</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>  
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">logp</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateLogP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">logp</span></div>
    
<div class="viewcode-block" id="PC_properties.CheckAcid"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CheckAcid">[docs]</a>    <span class="k">def</span> <span class="nf">CheckAcid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Judge a molecular whether is acid via SMARTS.</span>
<span class="sd">        These SMARTS retrived from https://www.daylight.com/dayhtml_tutorials/languages/smarts/smarts_examples.html</span>
<span class="sd">        ---&gt;ab</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: classification to acid or base</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">ab</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CheckAcid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ab</span>     </div>
      
          
<div class="viewcode-block" id="PC_properties.CalculatepKa"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculatepKa">[docs]</a>    <span class="k">def</span> <span class="nf">CalculatepKa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *This function should be revised*</span>
<span class="sd">        Calculating pKa based on the ralation between logD and logP in specific pH.</span>
<span class="sd">        ---&gt;pKa</span>
<span class="sd">        </span>
<span class="sd">        Eq.:</span>
<span class="sd">            abs(pH-pKa) = log10(10^(logP-logD)-1)</span>
<span class="sd">            pKa = pH - log10(10^(logP-logD)-1) for acid</span>
<span class="sd">            pKa = log10(10^(logP-logD)-1) - pH for base</span>
<span class="sd">            </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: molecular pKa</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">warnings</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">log10</span>
        <span class="n">logDl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalculateLogD</span><span class="p">()</span>
        <span class="n">logPl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CalculateLogP</span><span class="p">()</span>
        <span class="n">statusl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CheckAcid</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">status</span><span class="p">,</span><span class="n">logP</span><span class="p">,</span> <span class="n">logD</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">statusl</span><span class="p">,</span><span class="n">logPl</span><span class="p">,</span><span class="n">logDl</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;acid&#39;</span><span class="p">:</span>
                    <span class="n">pKa</span> <span class="o">=</span> <span class="mf">7.4</span> <span class="o">-</span> <span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">logP</span><span class="o">-</span><span class="n">logD</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pKa</span> <span class="o">=</span> <span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">logP</span><span class="o">-</span><span class="n">logD</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">7.4</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pKa</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>
        
<div class="viewcode-block" id="PC_properties.CalculateMolMR"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateMolMR">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateMolMR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cacluation of molecular refraction value based on Crippen method </span>
<span class="sd">        ---&gt;MR</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: molecular refraction value based on Crippen method</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">mr</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateMolMR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">mr</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumHDonors"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumHDonors">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumHDonors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>    
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Caculation of the number of Hydrogen Bond Donors</span>
<span class="sd">        ---&gt;nHD</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of Hydrogen Bond Donors</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nHD</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumHDonors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nHD</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumHAcceptors"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumHAcceptors">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumHAcceptors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>    
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Caculation of the number of Hydrogen Bond Acceptors  </span>
<span class="sd">        ---&gt;nHA</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of Hydrogen Bond Acceptors</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nHA</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumHAcceptors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nHA</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumHyBond"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumHyBond">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumHyBond</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sum of Hydrogen Bond Donnors and Acceptors   </span>
<span class="sd">        ---&gt;nHB</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: sum of Hydrogen Bond Donnors and Acceptors</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nHB</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumHyBond</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nHB</span></div>
    
    
<div class="viewcode-block" id="PC_properties.CalculateAromaticProportion"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateAromaticProportion">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateAromaticProportion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The proportion of heavy atoms in the molecule that are in an aromatic ring  </span>
<span class="sd">        ---&gt;AP</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the proportion of heavy atoms in the molecule that are in an aromatic ring  </span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">aroma</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateAromaticProportion</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">aroma</span></div>
        
    
<div class="viewcode-block" id="PC_properties.CalculateLogSw"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateLogSw">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateLogSw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The logSw represents the logarithm of compounds water solubility computed by the ESOL method</span>
<span class="sd">        ---&gt;logSw</span>
<span class="sd">        </span>
<span class="sd">        Equation: </span>
<span class="sd">            Log(Sw) = 0.16-0.638*clogP-0.0062*MWT+0.066*RB-0.74*AP</span>
<span class="sd">            where, MWT: Molecular Weight; RB: Rotatable bonds; AP: Aromatic proportion</span>
<span class="sd">        </span>
<span class="sd">        Reference:</span>
<span class="sd">            (1) `Delaney, John S (2004)`_. </span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the molecular logSw</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        .. _Delaney, John S (2004):</span>
<span class="sd">            https://pubs.acs.org/doi/abs/10.1021/ci034243x</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">logSw</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateLogSw</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">logSw</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateFsp3"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateFsp3">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateFsp3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fsp3 (carbon bond saturation) is defined as the number of sp3 hybridized carbons / total carbon count.   </span>
<span class="sd">        ---&gt;FSP3</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the carbon bond saturation</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">fsp3</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateFsp3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fsp3</span></div>
        
<div class="viewcode-block" id="PC_properties.CalculateTPSA"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateTPSA">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateTPSA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of TPSA   </span>
<span class="sd">        ---&gt;TPSA</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: TPSA</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">tpsa</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateTPSA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">tpsa</span></div>
        
               
<div class="viewcode-block" id="PC_properties.CalculateQEDmean"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateQEDmean">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateQEDmean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation QED descriptor under different weights </span>
<span class="sd">        A descriptor a measure of drug-likeness based on the concept of desirability</span>
<span class="sd">        Here, calculating the QED descriptor using average descriptor weights.</span>
<span class="sd">        ---&gt;QEDmean</span>
<span class="sd">        </span>
<span class="sd">        Reference:</span>
<span class="sd">            (1) `Bickerton, G. Richard (2012)`_.</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: QED descriptor using average descriptor weights</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        .. _Bickerton, G. Richard (2012):</span>
<span class="sd">            https://www.nature.com/nchem/journal/v4/n2/abs/nchem.1243.html</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>    
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">qed_mean</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateQEDmean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">qed_mean</span></div>
    
    
<div class="viewcode-block" id="PC_properties.CalculateQEDmax"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateQEDmax">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateQEDmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation QED descriptor under different weights   </span>
<span class="sd">        A descriptor a measure of drug-likeness based on the concept of desirability</span>
<span class="sd">        Here, calculating the QED descriptor using maximal descriptor weights.</span>
<span class="sd">        ---&gt;QEDmax</span>
<span class="sd">        </span>
<span class="sd">        Reference:</span>
<span class="sd">            (1) `Bickerton, G. Richard (2012)`_.</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: QED descriptor using maximal descriptor weights</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        .. _Bickerton, G. Richard (2012):</span>
<span class="sd">            https://www.nature.com/nchem/journal/v4/n2/abs/nchem.1243.html</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>    
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">qed_max</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateQEDmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">qed_max</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateQEDnone"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateQEDnone">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateQEDnone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation QED descriptor under different weights   </span>
<span class="sd">        A descriptor a measure of drug-likeness based on the concept of desirability</span>
<span class="sd">        Here, calculating the QED descriptor using unit weights.</span>
<span class="sd">        ---&gt;QEDnone</span>
<span class="sd">        </span>
<span class="sd">        Reference:</span>
<span class="sd">            (1) `Bickerton, G. Richard (2012)`_.</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: QED descriptor using unit weights</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        .. _Bickerton, G. Richard (2012):</span>
<span class="sd">            https://www.nature.com/nchem/journal/v4/n2/abs/nchem.1243.html</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>    
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">qed_none</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateQEDnone</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">qed_none</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateMaxSizeSystemRing"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateMaxSizeSystemRing">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateMaxSizeSystemRing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of atoms involved in the biggest system ring  </span>
<span class="sd">        ---&gt; maxring</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: number of atoms involved in the biggest system ring</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">maxring</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateMaxSizeSystemRing</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">maxring</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumStereocenters"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumStereocenters">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumStereocenters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *This can not implement under multiprocessing*</span>
<span class="sd">        The number of stereo centers</span>
<span class="sd">        ---&gt;nStereo</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of stereo centers</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nStereo</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumStereocenters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">nStereo</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="PC_properties.CalculateNumCarbon"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumCarbon">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumCarbon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of Carbon number in a molecule    </span>
<span class="sd">        ---&gt;nC</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of carbon atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nC</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumCarbon</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nC</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumBoron"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumBoron">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumBoron</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of Boron counts in a molecule  </span>
<span class="sd">        ---&gt;nB</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of boron atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>       
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nB</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumBoron</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nB</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumFluorin"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumFluorin">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumFluorin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of Fluorin counts in a molecule  </span>
<span class="sd">        ---&gt;nF</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of fluori atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>         
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nF</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumFluorin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nF</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumChlorin"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumChlorin">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumChlorin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of Chlorin counts in a molecule</span>
<span class="sd">        ---&gt;nCl</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of chlorin atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nCl</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumChlorin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nCl</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumBromine"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumBromine">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumBromine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of Bromine counts in a molecule  </span>
<span class="sd">        ---&gt;nBr</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of bromine atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nBr</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumBromine</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nBr</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumIodine"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumIodine">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumIodine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of Iodine counts in a molecule </span>
<span class="sd">        ---&gt;nI</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of bromine atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nI</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumIodine</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nI</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumPhosphor"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumPhosphor">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumPhosphor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calcualtion of Phosphor number in a molecule</span>
<span class="sd">        ---&gt;nP</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of phosphor atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nP</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumPhosphor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nP</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumSulfur"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumSulfur">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumSulfur</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of Sulfur counts in a molecule  </span>
<span class="sd">        ---&gt;nS</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of sulfur atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nS</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumSulfur</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nS</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumOxygen"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumOxygen">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumOxygen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of Oxygen counts in a molecule    </span>
<span class="sd">        ---&gt;nO</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of oxygen atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nO</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumOxygen</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nO</span></div>
            
<div class="viewcode-block" id="PC_properties.CalculateNumNitrogen"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumNitrogen">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumNitrogen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of Nitrogen counts in a molecule</span>
<span class="sd">        ---&gt;nN</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of nitrogen atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nN</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumNitrogen</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nN</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumChargedGroups"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumChargedGroups">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumChargedGroups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of Charged Groups </span>
<span class="sd">        ---&gt;nChar</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of charged group</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>
      
<div class="viewcode-block" id="PC_properties.CalculateHetCarbonRatio"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateHetCarbonRatio">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateHetCarbonRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The ratio between the number of non carbon atoms and the number of carbon atoms.</span>
<span class="sd">        ---&gt;HetRatio</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the ratio between the number of non carbon atoms and the number of carbon atoms</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">HetRatio</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateHetCarbonRatio</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">HetRatio</span></div>
        
<div class="viewcode-block" id="PC_properties.CalculateSAscore"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateSAscore">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateSAscore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function to estimate ease of synthesis (synthetic accessibility) of drug-like molecules</span>
<span class="sd">        ---&gt;SAscore</span>
<span class="sd">        </span>
<span class="sd">        Reference:</span>
<span class="sd">            (1) `Ertl, Peter, and Ansgar Schuffenhauer (2009)`_.</span>
<span class="sd">            </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: ease of synthesis</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        .. _Ertl, Peter, and Ansgar Schuffenhauer (2009):</span>
<span class="sd">            https://jcheminf.biomedcentral.com/articles/10.1186/1758-2946-1-8</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">SA</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateSAscore</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">SA</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNPscore"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNPscore">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNPscore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A function to calculate the natural product-likeness score</span>
<span class="sd">        ---&gt;NPscore</span>
<span class="sd">        </span>
<span class="sd">        Reference:</span>
<span class="sd">            (1) `Ertl (2008)`_.</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: product-likeness score</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        .. _Ertl (2008):</span>
<span class="sd">            https://jcheminf.biomedcentral.com/articles/10.1186/1758-2946-1-8</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">NP</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNPscore</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">NP</span></div>
            
<div class="viewcode-block" id="PC_properties.CalculateMolVolume"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateMolVolume">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateMolVolume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of Van der Waals Volume of molecule</span>
<span class="sd">        ---&gt;MV</span>
<span class="sd">        </span>
<span class="sd">        Equation: </span>
<span class="sd">            for single atom: Vw = 4/3*pi*rw^3, the rw is the Van der Waals radius of atom</span>
<span class="sd">            VvdW = ∑(atom contributions)-5.92NB(Unit in Å^3), NB is the total number of bonds</span>
<span class="sd">            the Van der Waals radius of atom is derived from wikipedia.</span>
<span class="sd">            </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: Van der Waals Volume of molecule</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">mv</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateMolVolume</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">mv</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateMolDensity"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateMolDensity">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateMolDensity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of density of molecule</span>
<span class="sd">        ---&gt;Dense</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: density of molecule</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">md</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateMolDensity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">md</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateMolFCharge"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateMolFCharge">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateMolFCharge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of formal charge of molecule</span>
<span class="sd">        ---&gt;fChar</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: formal charge of molecule</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">fChar</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateMolFCharge</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fChar</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumSinBond"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumSinBond">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumSinBond</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of single bond number of molecule</span>
<span class="sd">        ---&gt;nSingle</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of single bond</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nSingle</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumSinBond</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nSingle</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumDouBond"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumDouBond">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumDouBond</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of double bond number of molecule</span>
<span class="sd">        ---&gt;nDouble</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of double bond</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nDouble</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumDouBond</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nDouble</span></div>
    
<div class="viewcode-block" id="PC_properties.CalculateNumTriBond"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.CalculateNumTriBond">[docs]</a>    <span class="k">def</span> <span class="nf">CalculateNumTriBond</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculation of triple bond number of molecule</span>
<span class="sd">        ---&gt; nTriple</span>
<span class="sd">        </span>
<span class="sd">        :param mols: molecules</span>
<span class="sd">        :type mols: Iterable</span>
<span class="sd">        :return: the number of triple bond</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
        <span class="n">nTriple</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">molproperty</span><span class="o">.</span><span class="n">CalculateNumTriBond</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">nTriple</span></div>

<div class="viewcode-block" id="PC_properties.GetProperties"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty_Lib.PC_properties.GetProperties">[docs]</a>    <span class="k">def</span> <span class="nf">GetProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                      <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MW&#39;</span><span class="p">,</span><span class="s1">&#39;Vol&#39;</span><span class="p">,</span><span class="s1">&#39;Dense&#39;</span><span class="p">,</span><span class="s1">&#39;fChar&#39;</span><span class="p">,</span><span class="s1">&#39;nBond&#39;</span><span class="p">,</span><span class="s1">&#39;nAtom&#39;</span><span class="p">,</span><span class="s1">&#39;nHD&#39;</span><span class="p">,</span><span class="s1">&#39;nHA&#39;</span><span class="p">,</span><span class="s1">&#39;nHB&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;nHet&#39;</span><span class="p">,</span><span class="s1">&#39;nStereo&#39;</span><span class="p">,</span><span class="s1">&#39;nHev&#39;</span><span class="p">,</span><span class="s1">&#39;nRot&#39;</span><span class="p">,</span><span class="s1">&#39;nRig&#39;</span><span class="p">,</span><span class="s1">&#39;nRing&#39;</span><span class="p">,</span><span class="s1">&#39;Flex&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;logP&#39;</span><span class="p">,</span><span class="s1">&#39;logD&#39;</span><span class="p">,</span><span class="s1">&#39;pKa&#39;</span><span class="p">,</span><span class="s1">&#39;logSw&#39;</span><span class="p">,</span><span class="s1">&#39;ab&#39;</span><span class="p">,</span><span class="s1">&#39;MR&#39;</span><span class="p">,</span><span class="s1">&#39;TPSA&#39;</span><span class="p">,</span><span class="s1">&#39;AP&#39;</span><span class="p">,</span><span class="s1">&#39;HetRatio&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;Fsp3&#39;</span><span class="p">,</span><span class="s1">&#39;MaxRing&#39;</span><span class="p">,</span><span class="s1">&#39;QEDmean&#39;</span><span class="p">,</span><span class="s1">&#39;QEDmax&#39;</span><span class="p">,</span><span class="s1">&#39;QEDnone&#39;</span><span class="p">,</span><span class="s1">&#39;SAscore&#39;</span><span class="p">,</span><span class="s1">&#39;NPscore&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;nSingle&#39;</span><span class="p">,</span><span class="s1">&#39;nDouble&#39;</span><span class="p">,</span><span class="s1">&#39;nTriple&#39;</span><span class="p">,</span><span class="s1">&#39;nC&#39;</span><span class="p">,</span><span class="s1">&#39;nB&#39;</span><span class="p">,</span><span class="s1">&#39;nF&#39;</span><span class="p">,</span><span class="s1">&#39;nCl&#39;</span><span class="p">,</span><span class="s1">&#39;nBr&#39;</span><span class="p">,</span><span class="s1">&#39;nI&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;nP&#39;</span><span class="p">,</span><span class="s1">&#39;nS&#39;</span><span class="p">,</span><span class="s1">&#39;nO&#39;</span><span class="p">,</span><span class="s1">&#39;nN&#39;</span>
                               <span class="p">],</span>
                      <span class="n">showSMILES</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all PC - properties in scopy</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">funcl</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MW&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateMolWeight()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Vol&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateMolVolume()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dense&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateMolDensity()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;fChar&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateMolFCharge()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nBond&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumBonds()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nAtom&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumAtoms()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nHet&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumHetero()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nRot&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumRotatableBonds()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nRig&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumRigidBonds()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nRing&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumRing()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nHev&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumHeavyAtom()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;logP&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateLogP()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;logD&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateLogD()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;pKa&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculatepKa()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;ab&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CheckAcid()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;MR&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateMolMR()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nHD&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumHDonors()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nHA&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumHAcceptors()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nHB&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumHyBond()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;AP&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateAromaticProportion()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;logSw&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateLogSw()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Fsp3&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateFsp3()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;TPSA&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateTPSA()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;MaxRing&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateMaxSizeSystemRing()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nStereo&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumStereocenters()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Flex&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateFlexibility()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;HetRatio&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateHetCarbonRatio()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;QEDmean&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateQEDmean()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;QEDmax&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateQEDmax()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;QEDnone&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateQEDnone()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SAscore&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateSAscore()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;NPscore&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNPscore()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nSingle&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumSinBond()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nDouble&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumDouBond()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nTriple&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumTriBond()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nC&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumCarbon()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nB&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumBoron()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nF&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumFluorin()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nCl&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumChlorin()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nBr&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumBromine()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nI&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumIodine()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nP&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumPhosphor()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nS&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumSulfur()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nO&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumOxygen()&#39;</span><span class="p">,</span>
                <span class="s1">&#39;nN&#39;</span><span class="p">:</span> <span class="s1">&#39;self.CalculateNumNitrogen()&#39;</span><span class="p">,}</span>
        
    
        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">funcl</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
            <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">showSMILES</span><span class="p">:</span>
            <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
            <span class="n">smis</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map_async</span><span class="p">(</span><span class="n">_GetSmi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mols</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">pool</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">pool</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            
            <span class="n">items</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;SMILES&#39;</span><span class="p">)</span>
            <span class="n">vals</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">smis</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">vals</span><span class="p">))</span></div></div>
    
    
<span class="k">if</span> <span class="s1">&#39;__main__&#39;</span> <span class="o">==</span> <span class="vm">__name__</span><span class="p">:</span>
    <span class="n">smis</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;C1=CC=CC(C(Br)C)=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=CC2NC(=O)CC3C=2C(C(=O)C2C=CC=CC=23)=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=CC=C2C(=O)C3C=CNC=3C(=O)C2=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=NC(CCN)=CN1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1CCCC(CCO)C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=CC=C2N=C(O)C=CC2=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C(OC)1=C(C)C=C2OC[C@]([H])3OC4C(C)=C(OC)C=CC=4C(=O)[C@@]3([H])C2=C1C&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=C2N=CC=NC2=C2N=CNC2=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=C(O)C=CC(O)=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CCC1(c2ccccc2)C(=O)NC(=O)NC1=O&#39;</span><span class="p">,</span>
            <span class="s1">&#39;N1=CN=CN=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=C2C=CC=CC2=CC2C=CC=CC1=2&#39;</span><span class="p">,</span> <span class="c1">#NonGenotoxic_Carcinogenicity</span>
            <span class="s1">&#39;C1=CC=C2C(=O)CC(=O)C2=C1&#39;</span><span class="p">,</span> <span class="c1">#Pains</span>
            <span class="s1">&#39;C1=CC=CC(COCO)=C1&#39;</span><span class="p">,</span> <span class="c1">#Potential_Electrophilic</span>
            <span class="s1">&#39;N1=NC=CN1C=O&#39;</span><span class="p">,</span> <span class="c1">#Promiscuity</span>
            <span class="s1">&#39;CC(=O)OC(=O)C1C=COC1&#39;</span><span class="p">,</span> <span class="c1">#Skin_Sensitization</span>
            <span class="s1">&#39;S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CCCCC(=O)[H]&#39;</span><span class="p">,</span> <span class="c1">#Biodegradable</span>
            <span class="s1">&#39;C1=CN=C(C(=O)O)C=C1&#39;</span><span class="p">,</span> <span class="c1">#Chelating</span>
            <span class="s1">&#39;C(OC)1=CC=C2OCC3OC4C=C(OC)C=CC=4C(=O)C3C2=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=C2N=CC=NC2=C2N=CNC2=C1&#39;</span><span class="p">,</span> <span class="c1">#Genotoxic_Carcinogenicity_Mutagenicity</span>
            <span class="s1">&#39;N(CC)(CCCCC)C(=S)N&#39;</span><span class="p">,</span> <span class="c1">#Idiosyncratic</span>
            <span class="p">]</span>
    <span class="n">mols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span> <span class="k">for</span> <span class="n">smi</span> <span class="ow">in</span> <span class="n">smis</span><span class="p">]</span>
    <span class="n">pc</span> <span class="o">=</span> <span class="n">PC_properties</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">GetProperties</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Scopy 1.2.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../scopy.html" >scopy</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Zhijiang Yang.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.0.
    </div>
  </body>
</html>