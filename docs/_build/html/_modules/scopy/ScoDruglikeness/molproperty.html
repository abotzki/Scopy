
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>scopy.ScoDruglikeness.molproperty &#8212; Scopy 1.2.3 documentation</title>
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/./cssbasic.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Scopy 1.2.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../scopy.html" accesskey="U">scopy</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/Scopy.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for scopy.ScoDruglikeness.molproperty</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1">#Created on Tue Jun 25 21:59:42 2019</span>
<span class="c1">#</span>
<span class="c1">#@Author: Zhi-Jiang Yang, Dong-Sheng Cao</span>
<span class="c1">#@Institution: CBDD Group, Xiangya School of Pharmaceutical Science, CSU, Chinaï¼Œ</span>
<span class="c1">#@Homepage: http://www.scbdd.com</span>
<span class="c1">#@Mail: yzjkid9@gmail.com; oriental-cds@163.com</span>
<span class="c1">#@Blog: https://blog.moyule.me</span>



<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">combinations</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span><span class="nn">csv</span><span class="o">,</span><span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">rdkit</span> <span class="k">import</span> <span class="n">RDConfig</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="k">import</span> <span class="n">AllChem</span> <span class="k">as</span> <span class="n">Chem</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="k">import</span> <span class="n">Descriptors</span><span class="p">,</span> <span class="n">Lipinski</span><span class="p">,</span> <span class="n">QED</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem.Scaffolds</span> <span class="k">import</span> <span class="n">MurckoScaffold</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RDConfig</span><span class="o">.</span><span class="n">RDContribDir</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">SA_Score</span> <span class="k">import</span> <span class="n">sascorer</span>
<span class="kn">from</span> <span class="nn">NP_Score</span> <span class="k">import</span> <span class="n">npscorer</span>

<span class="kn">from</span> <span class="nn">..ScoRepresent.fingerprints</span> <span class="k">import</span> <span class="n">CalculateGhoseCrippen</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="k">import</span> <span class="n">ScoConfig</span>



<span class="n">ContriDir</span> <span class="o">=</span> <span class="n">RDConfig</span><span class="o">.</span><span class="n">RDContribDir</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ContriDir</span><span class="p">,</span> <span class="s1">&#39;NP_Score/publicnp.model.gz&#39;</span><span class="p">)</span>
<span class="n">fscore</span> <span class="o">=</span> <span class="n">npscorer</span><span class="o">.</span><span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">npscorer</span><span class="o">.</span><span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span> 


<div class="viewcode-block" id="CalculateMolWeight"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateMolWeight">[docs]</a><span class="k">def</span> <span class="nf">CalculateMolWeight</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of molecular weight(contain hydrogen atoms)   </span>
<span class="sd">    ---&gt;MW  </span>

<span class="sd">    :param mol: molecule</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the weight of molecule(contain hydrogen atoms)</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">MW</span> <span class="o">=</span> <span class="n">Descriptors</span><span class="o">.</span><span class="n">ExactMolWt</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">MW</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNumBonds"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumBonds">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumBonds</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation the number of bonds where between heavy atoms       </span>
<span class="sd">    ---&gt;nBond</span>
<span class="sd">        </span>
<span class="sd">    :param mol: molecule</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of bonds where between heavy atoms</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nBond</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumBonds</span><span class="p">()</span>    
    <span class="k">return</span> <span class="n">nBond</span></div>


<div class="viewcode-block" id="CalculateNumAtoms"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumAtoms">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumAtoms</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the number of atoms in molecular(contain hydrogen atoms) </span>
<span class="sd">    ---&gt;nAtom</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecule</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of atoms in molecular(contain hydrogen atoms)</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AddHs</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()</span></div>
   

<div class="viewcode-block" id="CalculateNumHetero"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumHetero">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumHetero</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the number of heteroatom in a molecule  </span>
<span class="sd">    ---&gt;nHet</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecule</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of heteroatom in a molecule  </span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
            <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()</span>\
             <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
            <span class="p">)</span>
    <span class="n">nHet</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">()</span><span class="o">-</span><span class="n">i</span>
    <span class="k">return</span> <span class="n">nHet</span></div>


<div class="viewcode-block" id="CalculateNumRotatableBonds"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumRotatableBonds">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumRotatableBonds</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the number of rotatableBonds</span>
<span class="sd">    ---&gt;nRot</span>
<span class="sd">    </span>
<span class="sd">    Note:</span>
<span class="sd">        In some situaion Amide C-N bonds are not considered </span>
<span class="sd">        because of their high rotational energy barrier</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecule</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of rotatableBond  </span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">patt</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="s1">&#39;[!$(*#*)&amp;!D1]-&amp;!@[!$(*#*)&amp;!D1]&#39;</span><span class="p">)</span>
    <span class="n">nRot</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">GetSubstructMatches</span><span class="p">(</span><span class="n">patt</span><span class="p">))</span>    
    <span class="k">return</span> <span class="n">nRot</span></div>


<div class="viewcode-block" id="CalculateNumRigidBonds"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumRigidBonds">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumRigidBonds</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Number of non-flexible bonds, in opposite to rotatable bonds    </span>
<span class="sd">    ---&gt;nRig</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecule</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of non-flexible bonds </span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nBOND</span> <span class="o">=</span> <span class="n">CalculateNumBonds</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>    
    <span class="n">flex</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">():</span>
        <span class="n">bondtype</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">bondtype</span> <span class="o">==</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">bond</span><span class="o">.</span><span class="n">IsInRing</span><span class="p">():</span>
            <span class="n">flex</span><span class="o">+=</span><span class="mi">1</span> 
    <span class="n">nRig</span> <span class="o">=</span> <span class="n">nBOND</span><span class="o">-</span><span class="n">flex</span>                
    <span class="k">return</span> <span class="n">nRig</span></div>


<div class="viewcode-block" id="CalculateFlexibility"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateFlexibility">[docs]</a><span class="k">def</span> <span class="nf">CalculateFlexibility</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The flexibility (ration between rotatable and rigid bonds)</span>
<span class="sd">    ---&gt;Flex</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecule</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of ring   </span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nRot</span> <span class="o">=</span> <span class="n">CalculateNumRotatableBonds</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">nRig</span> <span class="o">=</span> <span class="n">CalculateNumRigidBonds</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">nRot</span><span class="o">/</span><span class="n">nRig</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">nRig</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span></div>
   
    
<div class="viewcode-block" id="CalculateNumRing"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumRing">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumRing</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of the number of ring   </span>
<span class="sd">    ---&gt;nRing</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecule</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of ring   </span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nRing</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">GetSSSR</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>    
    <span class="k">return</span> <span class="n">nRing</span></div>


<div class="viewcode-block" id="CalculateNumHeavyAtom"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumHeavyAtom">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumHeavyAtom</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Heavy atom counts in a molecule   </span>
<span class="sd">    ---&gt;nHev</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of heavy atom counts in a molecule  </span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nHev</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetNumHeavyAtoms</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">nHev</span></div>


<div class="viewcode-block" id="CalculateLogD"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateLogD">[docs]</a><span class="k">def</span> <span class="nf">CalculateLogD</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of molecular logD under pH=7.4</span>
<span class="sd">    ---&gt;LogD</span>
<span class="sd">    </span>
<span class="sd">    Note:</span>
<span class="sd">        We have built a liner model with DNN to predict logD7.4.</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: molecular logD under pH=7.4 </span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="mf">0.5748907159915493</span>

    <span class="n">fps</span> <span class="o">=</span> <span class="n">CalculateGhoseCrippen</span><span class="p">([</span><span class="n">mol</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ScoConfig</span><span class="o">.</span><span class="n">CrippenDir</span><span class="p">,</span> <span class="s1">&#39;Crippen.txt&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f_obj</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f_obj</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">next</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="n">contri</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
        <span class="n">contri</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">contri</span><span class="p">]</span>
    <span class="n">f_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">logD</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fps</span><span class="p">,</span><span class="n">contri</span><span class="p">)])</span> <span class="o">+</span> <span class="n">intercept</span>
    <span class="k">return</span> <span class="n">logD</span></div>


<div class="viewcode-block" id="CalculateLogP"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateLogP">[docs]</a><span class="k">def</span> <span class="nf">CalculateLogP</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of molecular LogP</span>
<span class="sd">    ---&gt;logP</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: molecular logP </span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">logP</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">MolLogP</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>  
    <span class="k">return</span> <span class="n">logP</span></div>


<div class="viewcode-block" id="CheckAcid"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CheckAcid">[docs]</a><span class="k">def</span> <span class="nf">CheckAcid</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Judge a molecular whether is acid via SMARTS.</span>
<span class="sd">    These SMARTS retrived from https://www.daylight.com/dayhtml_tutorials/languages/smarts/smarts_examples.html</span>
<span class="sd">    ---&gt;ab</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: classification to acid or base</span>
<span class="sd">    :rtype: str</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">acid_fragment</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;[!H0;F,Cl,Br,I,N+,$([OH]-*=[!#6]),+]&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;[CX3](=O)[OX2H1]&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;[CX3](=O)[OX1H0-,OX2H1]&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;[$([OH]-*=[!#6])]&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;[$(P(=[OX1])([$([OX2H]),$([OX1-]),$([OX2]P)])([$([OX2H]),$([OX1-]),$([OX2]P)])[$([OX2H]),$([OX1-]),$([OX2]P)]),$([P+]([OX1-])([$([OX2H]),$([OX1-]),$([OX2]P)])([$([OX2H]),$([OX1-]),$([OX2]P)])[$([OX2H]),$([OX1-]),$([OX2]P)])]&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;[$([#16X4](=[OX1])(=[OX1])([#6])[OX2H,OX1H0-]),$([#16X4+2]([OX1-])([OX1-])([#6])[OX2H,OX1H0-])]&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;[CX3](=[OX1])[F,Cl,Br,I]&#39;</span>
                     <span class="p">]</span>
    <span class="k">for</span> <span class="n">sma</span> <span class="ow">in</span> <span class="n">acid_fragment</span><span class="p">:</span>
        <span class="n">patt</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">sma</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mol</span><span class="o">.</span><span class="n">HasSubstructMatch</span><span class="p">(</span><span class="n">patt</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;acid&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;base&#39;</span>        </div>
  
      
<div class="viewcode-block" id="CalculatepKa"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculatepKa">[docs]</a><span class="k">def</span> <span class="nf">CalculatepKa</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">log10</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculating pKa based on the ralation between logD and logP in specific pH.</span>
<span class="sd">    ---&gt;pKa</span>
<span class="sd">    </span>
<span class="sd">    Eq.:</span>
<span class="sd">        abs(pH-pKa) = log10(10^(logP-logD)-1)</span>
<span class="sd">        pKa = pH - log10(10^(logP-logD)-1) for acid</span>
<span class="sd">        pKa = log10(10^(logP-logD)-1) - pH for base</span>
<span class="sd">        </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: molecular pKa</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logP</span> <span class="o">=</span> <span class="n">CalculateLogP</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">logD</span> <span class="o">=</span> <span class="n">CalculateLogD</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">CheckAcid</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;acid&#39;</span><span class="p">:</span>
            <span class="n">pKa</span> <span class="o">=</span> <span class="mf">7.4</span> <span class="o">-</span> <span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">logP</span><span class="o">-</span><span class="n">logD</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pKa</span> <span class="o">=</span> <span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">logP</span><span class="o">-</span><span class="n">logD</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">7.4</span>
        <span class="k">return</span> <span class="n">pKa</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="CalculateMolMR"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateMolMR">[docs]</a><span class="k">def</span> <span class="nf">CalculateMolMR</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cacluation of molecular refraction value based on Crippen method </span>
<span class="sd">    ---&gt;MR</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: molecular refraction value based on Crippen method</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">MR</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">MolMR</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> 
    <span class="k">return</span> <span class="n">MR</span></div>


<div class="viewcode-block" id="CalculateNumHDonors"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumHDonors">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumHDonors</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Caculation of the number of Hydrogen Bond Donors</span>
<span class="sd">    ---&gt;nHD</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of Hydrogen Bond Donors</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nHD</span> <span class="o">=</span> <span class="n">Lipinski</span><span class="o">.</span><span class="n">NumHDonors</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>    
    <span class="k">return</span> <span class="n">nHD</span></div>


<div class="viewcode-block" id="CalculateNumHAcceptors"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumHAcceptors">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumHAcceptors</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Caculation of the number of Hydrogen Bond Acceptors  </span>
<span class="sd">    ---&gt;nHA</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of Hydrogen Bond Acceptors</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nHA</span> <span class="o">=</span> <span class="n">Lipinski</span><span class="o">.</span><span class="n">NumHAcceptors</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>    
    <span class="k">return</span> <span class="n">nHA</span></div>


<div class="viewcode-block" id="CalculateNumHyBond"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumHyBond">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumHyBond</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sum of Hydrogen Bond Donnors and Acceptors   </span>
<span class="sd">    ---&gt;nHB</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: sum of Hydrogen Bond Donnors and Acceptors</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nHD</span> <span class="o">=</span> <span class="n">CalculateNumHDonors</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">nHA</span> <span class="o">=</span> <span class="n">CalculateNumHAcceptors</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">nHB</span> <span class="o">=</span> <span class="n">nHD</span><span class="o">+</span><span class="n">nHA</span>
    <span class="k">return</span> <span class="n">nHB</span></div>


<div class="viewcode-block" id="CalculateNumAromaAtom"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumAromaAtom">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumAromaAtom</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of aromatic atom counts in a molecule</span>
<span class="sd">    ---&gt;nAAtom</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the aromatic atom counts in a molecule</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aroma</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">GetSubstructMatches</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="s1">&#39;[a]&#39;</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">aroma</span></div>


<div class="viewcode-block" id="CalculateNumAromaRing"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumAromaRing">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumAromaRing</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">aatom</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetSubstructMatches</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="s1">&#39;[a]&#39;</span><span class="p">))</span>
    <span class="n">aatom</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">aatom</span><span class="p">,())</span>
    <span class="k">if</span> <span class="n">aatom</span><span class="p">:</span>
        <span class="n">ringinfo</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetRingInfo</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">ringinfo</span><span class="o">.</span><span class="n">AtomRings</span><span class="p">():</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">info</span><span class="p">)</span><span class="o">&amp;</span><span class="nb">set</span><span class="p">(</span><span class="n">aatom</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">n</span></div>


<div class="viewcode-block" id="CalculateAromaticProportion"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateAromaticProportion">[docs]</a><span class="k">def</span> <span class="nf">CalculateAromaticProportion</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The proportion of heavy atoms in the molecule that are in an aromatic ring  </span>
<span class="sd">    ---&gt;AP</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the proportion of heavy atoms in the molecule that are in an aromatic ring  </span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aroma</span> <span class="o">=</span> <span class="n">CalculateNumAromaAtom</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">CalculateNumHeavyAtom</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">AP</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">aroma</span><span class="o">/</span><span class="n">total</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">total</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">AP</span>  </div>
    

<div class="viewcode-block" id="CalculateLogSw"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateLogSw">[docs]</a><span class="k">def</span> <span class="nf">CalculateLogSw</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The logSw represents the logarithm of compounds water solubility computed by the ESOL method</span>
<span class="sd">    ---&gt;logSw</span>
<span class="sd">    </span>
<span class="sd">    Equation: </span>
<span class="sd">        Log(Sw) = 0.16-0.638*clogP-0.0062*MWT+0.066*RB-0.74*AP</span>
<span class="sd">        where, MWT: Molecular Weight; RB: Rotatable bonds; AP: Aromatic proportion</span>
<span class="sd">    </span>
<span class="sd">    Reference:</span>
<span class="sd">        (1) `Delaney, John S (2004)`_. </span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the molecular logSw</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    .. _Delaney, John S (2004):</span>
<span class="sd">        https://pubs.acs.org/doi/abs/10.1021/ci034243x</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#Calculate each property</span>
    <span class="n">MWT</span> <span class="o">=</span> <span class="n">CalculateMolWeight</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">RB</span> <span class="o">=</span> <span class="n">CalculateNumRotatableBonds</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">AP</span> <span class="o">=</span> <span class="n">CalculateAromaticProportion</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">logP</span> <span class="o">=</span> <span class="n">CalculateLogP</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>  
    <span class="n">logSw</span> <span class="o">=</span> <span class="mf">0.16</span><span class="o">-</span><span class="mf">0.638</span><span class="o">*</span><span class="n">logP</span><span class="o">-</span><span class="mf">0.0062</span><span class="o">*</span><span class="n">MWT</span><span class="o">+</span><span class="mf">0.066</span><span class="o">*</span><span class="n">RB</span><span class="o">-</span><span class="mf">0.74</span><span class="o">*</span><span class="n">AP</span>   
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">logSw</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateFsp3"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateFsp3">[docs]</a><span class="k">def</span> <span class="nf">CalculateFsp3</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fsp3 (carbon bond saturation) is defined as the number of sp3 hybridized carbons / total carbon count.   </span>
<span class="sd">    ---&gt;FSP3</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the carbon bond saturation</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">Lipinski</span><span class="o">.</span><span class="n">FractionCSP3</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="CalculateTPSA"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateTPSA">[docs]</a><span class="k">def</span> <span class="nf">CalculateTPSA</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of TPSA   </span>
<span class="sd">    ---&gt;TPSA</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: TPSA</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TPSA</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">Descriptors</span><span class="o">.</span><span class="n">TPSA</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TPSA</span></div>
    
           
<div class="viewcode-block" id="CalculateQEDmean"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateQEDmean">[docs]</a><span class="k">def</span> <span class="nf">CalculateQEDmean</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation QED descriptor under different weights </span>
<span class="sd">    A descriptor a measure of drug-likeness based on the concept of desirability</span>
<span class="sd">    Here, calculating the QED descriptor using average descriptor weights.</span>
<span class="sd">    ---&gt;QEDmean</span>
<span class="sd">    </span>
<span class="sd">    Reference:</span>
<span class="sd">        (1) `Bickerton, G. Richard (2012)`_.</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: QED descriptor using average descriptor weights</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    .. _Bickerton, G. Richard (2012):</span>
<span class="sd">        https://www.nature.com/nchem/journal/v4/n2/abs/nchem.1243.html</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">QEDmean</span> <span class="o">=</span> <span class="n">QED</span><span class="o">.</span><span class="n">weights_mean</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>        
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">QEDmean</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> </div>


<div class="viewcode-block" id="CalculateQEDmax"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateQEDmax">[docs]</a><span class="k">def</span> <span class="nf">CalculateQEDmax</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation QED descriptor under different weights   </span>
<span class="sd">    A descriptor a measure of drug-likeness based on the concept of desirability</span>
<span class="sd">    Here, calculating the QED descriptor using maximal descriptor weights.</span>
<span class="sd">    ---&gt;QEDmax</span>
<span class="sd">    </span>
<span class="sd">    Reference:</span>
<span class="sd">        (1) `Bickerton, G. Richard (2012)`_.</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: QED descriptor using maximal descriptor weights</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    .. _Bickerton, G. Richard (2012):</span>
<span class="sd">        https://www.nature.com/nchem/journal/v4/n2/abs/nchem.1243.html</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">QEDmax</span> <span class="o">=</span> <span class="n">QED</span><span class="o">.</span><span class="n">weights_max</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>        
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">QEDmax</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>     </div>


<div class="viewcode-block" id="CalculateQEDnone"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateQEDnone">[docs]</a><span class="k">def</span> <span class="nf">CalculateQEDnone</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation QED descriptor under different weights   </span>
<span class="sd">    A descriptor a measure of drug-likeness based on the concept of desirability</span>
<span class="sd">    Here, calculating the QED descriptor using unit weights.</span>
<span class="sd">    ---&gt;QEDnone</span>
<span class="sd">    </span>
<span class="sd">    Reference:</span>
<span class="sd">        (1) `Bickerton, G. Richard (2012)`_.</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: QED descriptor using unit weights</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    .. _Bickerton, G. Richard (2012):</span>
<span class="sd">        https://www.nature.com/nchem/journal/v4/n2/abs/nchem.1243.html</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">QEDnone</span> <span class="o">=</span> <span class="n">QED</span><span class="o">.</span><span class="n">weights_none</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>        
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">QEDnone</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateMaxSizeSystemRing"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateMaxSizeSystemRing">[docs]</a><span class="k">def</span> <span class="nf">CalculateMaxSizeSystemRing</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Number of atoms involved in the biggest system ring  </span>
<span class="sd">    ---&gt; maxring</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: number of atoms involved in the biggest system ring</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#0.Get the scaffold</span>
    <span class="n">core</span> <span class="o">=</span> <span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">GetScaffoldForMol</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">fw</span> <span class="o">=</span> <span class="n">MurckoScaffold</span><span class="o">.</span><span class="n">MakeScaffoldGeneric</span><span class="p">(</span><span class="n">core</span><span class="p">)</span>
    <span class="c1">#1.Obtaining which atoms consist of rings</span>
    <span class="n">MaxRing</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ri</span> <span class="o">=</span> <span class="n">fw</span><span class="o">.</span><span class="n">GetRingInfo</span><span class="p">()</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ri</span><span class="o">.</span><span class="n">AtomRings</span><span class="p">())</span>    
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>    
    <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rw</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">RWMol</span><span class="p">(</span><span class="n">fw</span><span class="p">)</span>        
        <span class="c1">#2.Judge which atoms are replacement</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">]</span>            
        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">),</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">replace</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">&amp;</span><span class="n">atoms</span><span class="p">[</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">replace</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">repl</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">(</span><span class="n">replace</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
                    <span class="n">rw</span><span class="o">.</span><span class="n">RemoveBond</span><span class="p">(</span><span class="o">*</span><span class="n">repl</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>    
        <span class="n">m</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">rw</span><span class="p">))</span>
        <span class="n">ri</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">GetRingInfo</span><span class="p">()</span>
        <span class="n">bonds</span> <span class="o">=</span> <span class="n">ri</span><span class="o">.</span><span class="n">BondRings</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">bonds</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MaxRing</span><span class="p">:</span>
                <span class="n">MaxRing</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>   
    <span class="k">return</span> <span class="n">MaxRing</span></div>
    

<div class="viewcode-block" id="CalculateNumStereocenters"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumStereocenters">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumStereocenters</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    the number of stereo centers</span>
<span class="sd">    ---&gt;nStereo</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of stereo centers</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Chem</span><span class="o">.</span><span class="n">CalcNumAtomStereoCenters</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>    </div>


<span class="k">def</span> <span class="nf">_CalculateNumElement</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">AtomicNumber</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Internal used only**</span>
<span class="sd">    Calculation of specific type of atom number in a molecule</span>
<span class="sd">    </span>
<span class="sd">    Calculation of element counts with atomic number equal to n in a molecule</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :param AtomicNumber: the AtomicNumber of atom to be counted, defaults to 6</span>
<span class="sd">    :type AtomicNumber: int, optional</span>
<span class="sd">    :return: the number of stereo centers</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span>
            <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()</span>\
                <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()</span> <span class="o">==</span> <span class="n">AtomicNumber</span><span class="p">]</span>
            <span class="p">)</span>


<div class="viewcode-block" id="CalculateNumCarbon"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumCarbon">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumCarbon</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Carbon number in a molecule    </span>
<span class="sd">    ---&gt;nC</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of carbon atoms</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CalculateNumElement</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">AtomicNumber</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNumBoron"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumBoron">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumBoron</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Boron counts in a molecule  </span>
<span class="sd">    ---&gt;nB</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of boron atoms</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>       
    <span class="k">return</span> <span class="n">_CalculateNumElement</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">AtomicNumber</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNumFluorin"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumFluorin">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumFluorin</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Fluorin counts in a molecule  </span>
<span class="sd">    ---&gt;nF</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of fluori atoms</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>         
    <span class="k">return</span> <span class="n">_CalculateNumElement</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">AtomicNumber</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNumChlorin"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumChlorin">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumChlorin</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Chlorin counts in a molecule</span>
<span class="sd">    ---&gt;nCl</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of chlorin atoms</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CalculateNumElement</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">AtomicNumber</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNumBromine"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumBromine">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumBromine</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Bromine counts in a molecule  </span>
<span class="sd">    ---&gt;nBr</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of bromine atoms</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CalculateNumElement</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">AtomicNumber</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNumIodine"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumIodine">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumIodine</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Iodine counts in a molecule </span>
<span class="sd">    ---&gt;nI</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of bromine atoms</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CalculateNumElement</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">AtomicNumber</span><span class="o">=</span><span class="mi">53</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNumPhosphor"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumPhosphor">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumPhosphor</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calcualtion of Phosphor number in a molecule</span>
<span class="sd">    ---&gt;nP</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of phosphor atoms</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CalculateNumElement</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">AtomicNumber</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNumSulfur"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumSulfur">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumSulfur</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Sulfur counts in a molecule  </span>
<span class="sd">    ---&gt;nS</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of sulfur atoms</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CalculateNumElement</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">AtomicNumber</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNumOxygen"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumOxygen">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumOxygen</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Oxygen counts in a molecule    </span>
<span class="sd">    ---&gt;nO</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of oxygen atoms</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CalculateNumElement</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">AtomicNumber</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span></div>
        

<div class="viewcode-block" id="CalculateNumNitrogen"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumNitrogen">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumNitrogen</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Nitrogen counts in a molecule</span>
<span class="sd">    ---&gt;nN</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of nitrogen atoms</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CalculateNumElement</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">AtomicNumber</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span></div>


<span class="c1"># def CalculateNumberChargedGroups(mol):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     Number of Charged Groups </span>
<span class="c1">#     ---&gt;nChar</span>
    
<span class="c1">#     :param mol: molecular</span>
<span class="c1">#     :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="c1">#     :return: the number of charged group</span>
<span class="c1">#     :rtype: int</span>
    
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     pass</span>


<div class="viewcode-block" id="CalculateHetCarbonRatio"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateHetCarbonRatio">[docs]</a><span class="k">def</span> <span class="nf">CalculateHetCarbonRatio</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The ratio between the number of non carbon atoms and the number of carbon atoms.</span>
<span class="sd">    ---&gt;HetRatio</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the ratio between the number of non carbon atoms and the number of carbon atoms</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nHet</span> <span class="o">=</span> <span class="n">CalculateNumHetero</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">nCarb</span> <span class="o">=</span> <span class="n">CalculateNumCarbon</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">nHet</span><span class="o">/</span><span class="n">nCarb</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">nCarb</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="CalculateSAscore"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateSAscore">[docs]</a><span class="k">def</span> <span class="nf">CalculateSAscore</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function to estimate ease of synthesis (synthetic accessibility) of drug-like molecules</span>
<span class="sd">    ---&gt;SAscore</span>
<span class="sd">    </span>
<span class="sd">    Reference:</span>
<span class="sd">        (1) `Ertl Peter (2009)`_.</span>
<span class="sd">        </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: ease of synthesis</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    .. _Ertl Peter (2009):</span>
<span class="sd">        https://jcheminf.biomedcentral.com/articles/10.1186/1758-2946-1-8</span>
<span class="sd">        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">sascorer</span><span class="o">.</span><span class="n">calculateScore</span><span class="p">(</span><span class="n">mol</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNPscore"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNPscore">[docs]</a><span class="k">def</span> <span class="nf">CalculateNPscore</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function to calculate the natural product-likeness score</span>
<span class="sd">    ---&gt;NPscore</span>
<span class="sd">    </span>
<span class="sd">    Reference:</span>
<span class="sd">        (1) `Ertl Peter (2008)`_.</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: product-likeness score</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    .. _Ertl Peter (2008):</span>
<span class="sd">        https://pubs.acs.org/doi/abs/10.1021/ci700286x</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">npscorer</span><span class="o">.</span><span class="n">scoreMol</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">fscore</span><span class="o">=</span><span class="n">fscore</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="CalculateMolVolume"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateMolVolume">[docs]</a><span class="k">def</span> <span class="nf">CalculateMolVolume</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of Van der Waals Volume of molecule</span>
<span class="sd">    ---&gt;MV</span>
<span class="sd">    </span>
<span class="sd">    Equation: </span>
<span class="sd">        for single atom: Vw = 4/3*pi*rw^3, the rw is the Van der Waals radius of atom</span>
<span class="sd">        VvdW = âˆ‘(atom contributions)-5.92NB(Unit in Ã…^3), NB is the total number of bonds</span>
<span class="sd">        the Van der Waals radius of atom is derived from wikipedia.</span>
<span class="sd">        </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: Van der Waals Volume of molecule</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">pi</span>
    <span class="n">Radii</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mf">1.20</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mf">1.70</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">:</span><span class="mf">1.55</span><span class="p">,</span>
             <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mf">1.52</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="mf">1.80</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">:</span><span class="mf">1.80</span><span class="p">,</span>
             <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mf">1.47</span><span class="p">,</span><span class="s1">&#39;Cl&#39;</span><span class="p">:</span><span class="mf">1.75</span><span class="p">,</span><span class="s1">&#39;Br&#39;</span><span class="p">:</span><span class="mf">1.85</span><span class="p">,</span>
             <span class="s1">&#39;I&#39;</span><span class="p">:</span><span class="mf">1.98</span><span class="p">,</span><span class="s1">&#39;Na&#39;</span><span class="p">:</span><span class="mf">2.27</span><span class="p">,</span><span class="s1">&#39;Mg&#39;</span><span class="p">:</span><span class="mf">1.73</span><span class="p">,</span>
             <span class="s1">&#39;K&#39;</span><span class="p">:</span><span class="mf">2.75</span><span class="p">,</span><span class="s1">&#39;Ca&#39;</span><span class="p">:</span><span class="mf">2.31</span><span class="p">,</span><span class="s1">&#39;Ba&#39;</span><span class="p">:</span><span class="mf">2.68</span><span class="p">,</span>
             <span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="mi">140</span><span class="p">,</span><span class="s1">&#39;Li&#39;</span><span class="p">:</span><span class="mi">182</span><span class="p">,</span><span class="s1">&#39;Be&#39;</span><span class="p">:</span><span class="mi">153</span><span class="p">,</span>
             <span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="mi">192</span><span class="p">,</span><span class="s1">&#39;Ne&#39;</span><span class="p">:</span><span class="mi">154</span><span class="p">,</span><span class="s1">&#39;Al&#39;</span><span class="p">:</span><span class="mi">184</span><span class="p">,</span>
             <span class="s1">&#39;Si&#39;</span><span class="p">:</span><span class="mi">210</span><span class="p">,</span><span class="s1">&#39;Ar&#39;</span><span class="p">:</span><span class="mi">188</span><span class="p">,</span><span class="s1">&#39;Ni&#39;</span><span class="p">:</span><span class="mi">163</span><span class="p">,</span>
             <span class="s1">&#39;Cu&#39;</span><span class="p">:</span><span class="mi">140</span><span class="p">,</span><span class="s1">&#39;Zn&#39;</span><span class="p">:</span><span class="mi">139</span><span class="p">,</span><span class="s1">&#39;Ga&#39;</span><span class="p">:</span><span class="mi">187</span><span class="p">,</span>
             <span class="s1">&#39;Ge&#39;</span><span class="p">:</span><span class="mi">211</span><span class="p">,</span><span class="s1">&#39;As&#39;</span><span class="p">:</span><span class="mi">185</span><span class="p">,</span><span class="s1">&#39;Se&#39;</span><span class="p">:</span><span class="mi">190</span><span class="p">,</span>
             <span class="s1">&#39;Kr&#39;</span><span class="p">:</span><span class="mi">202</span><span class="p">,</span><span class="s1">&#39;Rb&#39;</span><span class="p">:</span><span class="mi">303</span><span class="p">,</span><span class="s1">&#39;Sr&#39;</span><span class="p">:</span><span class="mi">249</span><span class="p">,</span>
             <span class="s1">&#39;Pd&#39;</span><span class="p">:</span><span class="mi">163</span><span class="p">,</span><span class="s1">&#39;Ag&#39;</span><span class="p">:</span><span class="mi">172</span><span class="p">,</span><span class="s1">&#39;Cd&#39;</span><span class="p">:</span><span class="mi">158</span><span class="p">,</span>
             <span class="s1">&#39;In&#39;</span><span class="p">:</span><span class="mi">193</span><span class="p">,</span><span class="s1">&#39;Sn&#39;</span><span class="p">:</span><span class="mi">217</span><span class="p">,</span><span class="s1">&#39;Sb&#39;</span><span class="p">:</span><span class="mi">206</span><span class="p">,</span>
             <span class="s1">&#39;Te&#39;</span><span class="p">:</span><span class="mi">206</span><span class="p">,</span><span class="s1">&#39;Xe&#39;</span><span class="p">:</span><span class="mi">216</span><span class="p">,</span><span class="s1">&#39;Cs&#39;</span><span class="p">:</span><span class="mi">343</span><span class="p">,</span>
             <span class="s1">&#39;Pt&#39;</span><span class="p">:</span><span class="mi">175</span><span class="p">,</span><span class="s1">&#39;Au&#39;</span><span class="p">:</span><span class="mi">166</span><span class="p">,</span><span class="s1">&#39;U&#39;</span><span class="p">:</span><span class="mi">186</span><span class="p">,</span>
             <span class="s1">&#39;Hg&#39;</span><span class="p">:</span><span class="mi">155</span><span class="p">,</span><span class="s1">&#39;Tl&#39;</span><span class="p">:</span><span class="mi">196</span><span class="p">,</span><span class="s1">&#39;Pb&#39;</span><span class="p">:</span><span class="mi">202</span><span class="p">,</span>
             <span class="s1">&#39;Bi&#39;</span><span class="p">:</span><span class="mi">207</span><span class="p">,</span><span class="s1">&#39;Po&#39;</span><span class="p">:</span><span class="mi">197</span><span class="p">,</span><span class="s1">&#39;At&#39;</span><span class="p">:</span><span class="mi">202</span><span class="p">,</span>
             <span class="s1">&#39;Rn&#39;</span><span class="p">:</span><span class="mi">220</span><span class="p">,</span><span class="s1">&#39;Fr&#39;</span><span class="p">:</span><span class="mi">348</span><span class="p">,</span><span class="s1">&#39;Ra&#39;</span><span class="p">:</span><span class="mi">283</span><span class="p">}</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AddHs</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">contrib</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">contrib</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Radii</span><span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">GetSymbol</span><span class="p">()])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="c1"># contrib = [Radii[atom.GetSymbol()] for atom in mol.GetAtoms()]</span>
    <span class="n">contrib</span> <span class="o">=</span> <span class="p">[</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">contrib</span><span class="p">]</span>
    <span class="n">vol</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">contrib</span><span class="p">)</span> <span class="o">-</span> <span class="mf">5.92</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">())</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateMolDensity"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateMolDensity">[docs]</a><span class="k">def</span> <span class="nf">CalculateMolDensity</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of density of molecule</span>
<span class="sd">    ---&gt;Dense</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: density of molecule</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">MW</span> <span class="o">=</span> <span class="n">CalculateMolWeight</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">Vol</span> <span class="o">=</span> <span class="n">CalculateMolVolume</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">MW</span><span class="o">/</span><span class="n">Vol</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">Vol</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateMolFCharge"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateMolFCharge">[docs]</a><span class="k">def</span> <span class="nf">CalculateMolFCharge</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of formal charge of molecule</span>
<span class="sd">    ---&gt;fChar</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: formal charge of molecule</span>
<span class="sd">    :rtype: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">AddHs</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">FChar</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span><span class="o">.</span><span class="n">GetFormalCharge</span><span class="p">()</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtoms</span><span class="p">()]</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">FChar</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_CalculateNumBond</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span><span class="n">btype</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    **Internal used only**</span>
<span class="sd">    Calculation of specific type of bond number in a molecule</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :param btype: the type of bond to be counted</span>
<span class="sd">    :type btype: str</span>
<span class="sd">    :return: the number of specific bond</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">btype</span> <span class="o">==</span> <span class="s1">&#39;SINGLE&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">([</span><span class="n">bond</span> <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">()</span> 
                    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="s1">&#39;DOUBLE&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">([</span><span class="n">bond</span> <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">()</span> 
                    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">DOUBLE</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">btype</span> <span class="o">==</span> <span class="s1">&#39;TRIPLE&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">([</span><span class="n">bond</span> <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetBonds</span><span class="p">()</span> 
                    <span class="k">if</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetBondType</span><span class="p">()</span> <span class="o">==</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdchem</span><span class="o">.</span><span class="n">BondType</span><span class="o">.</span><span class="n">TRIPLE</span><span class="p">])</span>


<div class="viewcode-block" id="CalculateNumSinBond"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumSinBond">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumSinBond</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of single bond number of molecule</span>
<span class="sd">    ---&gt; nSingle</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of single bond</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CalculateNumBond</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;SINGLE&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNumDouBond"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumDouBond">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumDouBond</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of double bond number of molecule</span>
<span class="sd">    ---&gt;nDouble</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of double bond</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CalculateNumBond</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;DOUBLE&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="CalculateNumTriBond"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.CalculateNumTriBond">[docs]</a><span class="k">def</span> <span class="nf">CalculateNumTriBond</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;TRIPLE&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculation of triple bond number of molecule</span>
<span class="sd">    ---&gt; nTriple</span>
<span class="sd">    </span>
<span class="sd">    :param mol: molecular</span>
<span class="sd">    :type mol: rdkit.Chem.rdchem.Mol</span>
<span class="sd">    :return: the number of triple bond</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_CalculateNumBond</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;TRIPLE&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GetProperties"><a class="viewcode-back" href="../../../modules/scopy.ScoDruglikeness.html#scopy.ScoDruglikeness.molproperty.GetProperties">[docs]</a><span class="k">def</span> <span class="nf">GetProperties</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> 
                  <span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MW&#39;</span><span class="p">,</span><span class="s1">&#39;Vol&#39;</span><span class="p">,</span><span class="s1">&#39;Dense&#39;</span><span class="p">,</span><span class="s1">&#39;fChar&#39;</span><span class="p">,</span><span class="s1">&#39;nBond&#39;</span><span class="p">,</span><span class="s1">&#39;nAtom&#39;</span><span class="p">,</span><span class="s1">&#39;nHD&#39;</span><span class="p">,</span><span class="s1">&#39;nHA&#39;</span><span class="p">,</span><span class="s1">&#39;nHB&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;nHet&#39;</span><span class="p">,</span><span class="s1">&#39;nStereo&#39;</span><span class="p">,</span><span class="s1">&#39;nHev&#39;</span><span class="p">,</span><span class="s1">&#39;nRot&#39;</span><span class="p">,</span><span class="s1">&#39;nRig&#39;</span><span class="p">,</span><span class="s1">&#39;Flex&#39;</span><span class="p">,</span><span class="s1">&#39;nRing&#39;</span><span class="p">,</span><span class="s1">&#39;logP&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;logD&#39;</span><span class="p">,</span><span class="s1">&#39;pKa&#39;</span><span class="p">,</span><span class="s1">&#39;logSw&#39;</span><span class="p">,</span><span class="s1">&#39;ab&#39;</span><span class="p">,</span><span class="s1">&#39;MR&#39;</span><span class="p">,</span><span class="s1">&#39;TPSA&#39;</span><span class="p">,</span><span class="s1">&#39;AP&#39;</span><span class="p">,</span><span class="s1">&#39;HetRatio&#39;</span><span class="p">,</span><span class="s1">&#39;Fsp3&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;MaxRing&#39;</span><span class="p">,</span><span class="s1">&#39;QEDmean&#39;</span><span class="p">,</span><span class="s1">&#39;QEDmax&#39;</span><span class="p">,</span><span class="s1">&#39;QEDnone&#39;</span><span class="p">,</span><span class="s1">&#39;SAscore&#39;</span><span class="p">,</span><span class="s1">&#39;NPscore&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;nSingle&#39;</span><span class="p">,</span><span class="s1">&#39;nDouble&#39;</span><span class="p">,</span><span class="s1">&#39;nTriple&#39;</span><span class="p">,</span><span class="s1">&#39;nC&#39;</span><span class="p">,</span><span class="s1">&#39;nB&#39;</span><span class="p">,</span><span class="s1">&#39;nF&#39;</span><span class="p">,</span><span class="s1">&#39;nCl&#39;</span><span class="p">,</span><span class="s1">&#39;nBr&#39;</span><span class="p">,</span><span class="s1">&#39;nI&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;nP&#39;</span><span class="p">,</span><span class="s1">&#39;nS&#39;</span><span class="p">,</span><span class="s1">&#39;nO&#39;</span><span class="p">,</span><span class="s1">&#39;nN&#39;</span><span class="p">]</span>
        <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get all properties in scopy</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">funcl</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MW&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateMolWeight(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Vol&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateMolVolume(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dense&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateMolDensity(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fChar&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateMolFCharge(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nBond&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumBonds(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nAtom&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumAtoms(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nHet&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumHetero(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nRot&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumRotatableBonds(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nRig&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumRigidBonds(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Flex&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateFlexibility(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nRing&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumRing(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nHev&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumHeavyAtom(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;logP&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateLogP(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;logD&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateLogD(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pKa&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculatepKa(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ab&#39;</span><span class="p">:</span> <span class="s1">&#39;CheckAcid(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MR&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateMolMR(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nHD&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumHDonors(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nHA&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumHAcceptors(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nHB&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumHyBond(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AP&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateAromaticProportion(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;logSw&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateLogSw(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Fsp3&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateFsp3(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TPSA&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateTPSA(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MaxRing&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateMaxSizeSystemRing(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nStereo&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumStereocenters(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;HetRatio&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateHetCarbonRatio(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;QEDmean&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateQEDmean(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;QEDmax&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateQEDmax(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;QEDnone&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateQEDnone(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SAscore&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateSAscore(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NPscore&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNPscore(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nSingle&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumSinBond(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nDouble&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumDouBond(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nTriple&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumTriBond(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nC&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumCarbon(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nB&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumBoron(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nF&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumFluorin(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nCl&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumChlorin(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nBr&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumBromine(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nI&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumIodine(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nP&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumPhosphor(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nS&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumSulfur(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nO&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumOxygen(mol)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nN&#39;</span><span class="p">:</span> <span class="s1">&#39;CalculateNumNitrogen(mol)&#39;</span><span class="p">}</span>
    
    <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">funcl</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">vals</span><span class="p">))</span></div>




<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    
    <span class="n">smis</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;C1=CC=CC(C(Br)C)=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=CC2NC(=O)CC3C=2C(C(=O)C2C=CC=CC=23)=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=CC=C2C(=O)C3C=CNC=3C(=O)C2=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=NC(CCN)=CN1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1CCCC(CCO)C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=CC=C2N=C(O)C=CC2=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C(OC)1=C(C)C=C2OC[C@]([H])3OC4C(C)=C(OC)C=CC=4C(=O)[C@@]3([H])C2=C1C&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=C2N=CC=NC2=C2N=CNC2=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=C(O)C=CC(O)=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CCC1(c2ccccc2)C(=O)NC(=O)NC1=O&#39;</span><span class="p">,</span>
            <span class="s1">&#39;N1=CN=CN=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=C2C=CC=CC2=CC2C=CC=CC1=2&#39;</span><span class="p">,</span> <span class="c1">#NonGenotoxic_Carcinogenicity</span>
            <span class="s1">&#39;C1=CC=C2C(=O)CC(=O)C2=C1&#39;</span><span class="p">,</span> <span class="c1">#Pains</span>
            <span class="s1">&#39;C1=CC=CC(COCO)=C1&#39;</span><span class="p">,</span> <span class="c1">#Potential_Electrophilic</span>
            <span class="s1">&#39;N1=NC=CN1C=O&#39;</span><span class="p">,</span> <span class="c1">#Promiscuity</span>
            <span class="s1">&#39;CC(=O)OC(=O)C1C=COC1&#39;</span><span class="p">,</span> <span class="c1">#Skin_Sensitization</span>
            <span class="s1">&#39;S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CCCCC(=O)[H]&#39;</span><span class="p">,</span> <span class="c1">#Biodegradable</span>
            <span class="s1">&#39;C1=CN=C(C(=O)O)C=C1&#39;</span><span class="p">,</span> <span class="c1">#Chelating</span>
            <span class="s1">&#39;C(OC)1=CC=C2OCC3OC4C=C(OC)C=CC=4C(=O)C3C2=C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1=C2N=CC=NC2=C2N=CNC2=C1&#39;</span><span class="p">,</span> <span class="c1">#Genotoxic_Carcinogenicity_Mutagenicity</span>
            <span class="s1">&#39;N(CC)(CCCCC)C(=S)N&#39;</span><span class="p">,</span> <span class="c1">#Idiosyncratic</span>
            <span class="p">]</span>
    
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">smi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">smis</span><span class="p">):</span>
        <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Index:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">GetProperties</span><span class="p">(</span><span class="n">mol</span><span class="o">=</span><span class="n">mol</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    

        
        
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Scopy 1.2.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../scopy.html" >scopy</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Zhijiang Yang.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.0.
    </div>
  </body>
</html>